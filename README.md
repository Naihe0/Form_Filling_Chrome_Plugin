# 智能表单填充助手 (AI Form Filler)

这是一个基于大语言模型（LLM）的智能Chrome浏览器插件，旨在自动化填充网页表单的过程。它能够分析复杂的表单，并根据用户预先设定的个人画像信息，智能地完成填写和提交。

## ✨ 功能特性

- **AI驱动**：利用大型语言模型（如OpenAI的GPT系列）来理解表单字段的语义，而不是依赖固定的规则。
- **自然语言配置**：用户只需用自然语言描述自己的个人信息（用户画像），无需编写复杂的JSON或代码。
- **动态字段识别**：能够智能识别各种类型的输入字段，包括文本框、下拉选择、单选按钮、复选框等。
- **智能纠错**：当第一次尝试填充失败时，插件会自动截取相关HTML片段，再次请求LLM进行分析，并尝试使用修正后的选择器进行填充。
- **歧义处理**：当一个选择器匹配到多个元素时，插件会根据字段描述文本（问题）与元素周边文本的关联性，智能选择最匹配的元素。
- **可视化操作反馈**：在页面上实时显示当前正在处理的字段，并以不同颜色的边框高亮显示填充状态（处理中、成功、失败）。
- **云端同步**：支持与 [mem0.ai](https://mem0.ai) 平台联动，实现用户画像的云端存储、拉取和同步，确保信息在多设备间的一致性。
- **灵活配置**：提供UI界面，方便用户随时填写和修改 mem0 相关参数（如 API Key, Agent ID 等），配置信息持久化保存。
- **模块化代码**：核心的字段处理逻辑被封装在 `fieldProcessor.js` 中，使得代码更易于维护和扩展。

## 🚀 工作流程

1.  **用户配置**：
    - **本地模式**：用户在插件的“用户画像”视图中输入描述个人信息的文本。
    - **云端模式**：用户启用 mem0 同步，并在弹出的对话框中填写自己的 mem0 API Key 及相关参数（Agent ID, User ID 等）。
    - 用户在“开始填充”视图中输入自己的大模型 API Key（如 OpenAI）。
2.  **启动填充**：用户在目标网页上点击“开始填充”按钮。
3.  **获取画像**：如果启用了 mem0，插件会从 mem0.ai 云端拉取最新的用户画像；否则，使用本地保存的画像。
4.  **注入脚本**：插件会将核心逻辑脚本 (`fieldProcessor.js` 和 `content.js`) 注入到当前页面。
5.  **页面分析**：`content.js` 脚本启动，首先将页面的HTML进行分块和清洗（移除脚本、样式等无关元素），然后将HTML块和用户画像发送给LLM，请求其识别出所有需要填充的表单字段（包括问题、CSS选择器和动作）。
6.  **字段处理**：`content.js` 接收到LLM返回的字段列表后，会逐一调用 `fieldProcessor.js` 中的 `processSingleField` 方法进行处理。
7.  **执行与验证**：`fieldProcessor.js` 负责具体执行操作（如输入、点击），处理歧义，并在操作失败时启动LLM纠错流程。
8.  **完成**：所有字段处理完毕后，插件会显示完成状态。

## 🛠️ 文件结构

- `manifest.json`: 插件的配置文件，定义了权限、背景脚本、图标等。
- `popup.html` / `popup.css` / `popup.js`: 插件弹出窗口的界面和交互逻辑。
- `background.js`: 后台服务脚本，主要负责代理对OpenAI API的请求，以保护API Key不直接暴露在内容脚本中。
- `content.js`: 内容脚本，是插件在目标页面上运行的主要逻辑，负责UI绘制、页面分析和任务调度。
- `fieldProcessor.js`: 字段处理器，封装了所有与单个字段交互的复杂逻辑，包括元素定位、歧义处理、动作执行和LLM纠错。
- `icons/`: 存放插件所需的各种尺寸的图标。

## 🔧 安装与使用

### 安装步骤

1.  下载或克隆此代码仓库到本地。
2.  打开Chrome浏览器，地址栏输入 `chrome://extensions` 并回车。
3.  在页面右上角，打开“开发者模式”开关。
4.  点击“加载已解压的扩展程序”按钮，然后选择代码仓库所在的文件夹。

### 使用方法

1.  点击浏览器工具栏上的插件图标。
2.  在“用户画像”标签页，你可以选择：
    - **本地填写**：直接在文本框中输入描述你个人信息的文本，然后点击保存。新增的画像会追加到历史记录中。
    - **云端同步**：打开“上传用户画像至 mem0”开关。在保存新画像时，如果 mem0 参数未配置，会自动弹窗提示你输入。输入的内容会上传到你的 mem0 账户。
3.  在“开始填充”标签页：
    - 输入你的大模型 API Key（例如 OpenAI 的 Key）。
    - 打开“从 mem0 获取用户画像”开关，插件将使用云端的用户画像进行填充。如果参数缺失，点击“开始填充”时会弹窗提示。
4.  打开一个包含表单的网页。
5.  再次点击插件图标，然后点击“开始填充”按钮。
6.  观察插件自动完成表单填充的过程。如果需要，可以随时点击“停止填充”按钮来中断操作。
7.  如果在填充或上传过程中遇到 mem0 参数错误，状态栏下方会出现“修改 mem0 参数”按钮，方便你随时更正。
